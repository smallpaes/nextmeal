(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bc78103c"],{"0489":function(t,e,r){"use strict";r("7f7f");var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card shadow",attrs:{href:"#"}},[e("div",{staticClass:"card-img-top-container"},[e("img",{staticClass:"card-img-top",attrs:{src:t.order.meal.image,alt:"photo of the restaurant"}})]),e("div",{staticClass:"card-body"},[e("h5",{staticClass:"card-title m-0"},[t._v("\n      "+t._s(t.order.meal.name)+"\n    ")]),e("p",{staticClass:"card-text mt-1"},[e("span",{staticClass:"rating"},[t._v("★ "+t._s(t._f("padEnd")(t.order.restaurant.rating)))]),e("span",{staticClass:"mx-1"},[t._v("|")]),t._v(t._s(t._f("textTruncate")(t.order.restaurant.name,15))+"\n      "),t._t("distance")],2),t._t("indicator"),e("p",{staticClass:"card-text"},[t._v("\n      "+t._s(t._f("textTruncate")(t.order.meal.description))+"\n    ")])],2),e("div",{staticClass:"card-footer text-right"},[t._t("footer")],2)])},n=[],s=r("d1b6"),i=r("2708"),o={components:{SkelentonBox:s["a"]},mixins:[i["e"],i["g"]],props:{order:{type:Object,required:!0}}},c=o,l=(r("55d0"),r("2877")),u=Object(l["a"])(c,a,n,!1,null,"0b594ecd",null);e["a"]=u.exports},"55d0":function(t,e,r){"use strict";r("80e8")},"747a":function(t,e,r){"use strict";r("c710")},"80e8":function(t,e,r){},"8a5f":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t._self._c;return e("section",[e("UserNavbar"),t.isLoading?e("Loader",{attrs:{height:"100vh"}}):t._e(),e("transition",{attrs:{name:"fade"}},[t.isLoading?t._e():e("header",[e("ImageHeaderBanner",{attrs:{"background-photo":t.banner.image,"banner-height":t.banner.height},scopedSlots:t._u([{key:"header",fn:function(){return[e("h1",{staticClass:"banner-content-title"},[t._v("\n            訂購餐點\n          ")]),t.isChoosingMeal?e("h3",{staticClass:"banner-content-description"},[t._v("\n            餐點二選一\n          ")]):e("h3",{staticClass:"banner-content-description"},[t._v("\n            選擇數量與領餐時間\n          ")])]},proxy:!0}],null,!1,2390136964)})],1)]),e("transition",{attrs:{name:"slide",mode:"out-in"}},[t.isChoosingMeal&&!t.isLoading?e("section",{key:"meals",staticClass:"meal-wrapper"},[e("div",{staticClass:"container meal-container"},[e("div",{staticClass:"row meal-content align-items-stretch"},t._l(2,(function(r){return e("div",{key:r,staticClass:"col-12 col-md-6 col-lg-5 mb-4 meal-card"},[t.meals[r-1]?e("MealVerticalCard",{attrs:{order:t.meals[r-1]},scopedSlots:t._u([{key:"footer",fn:function(){return[e("button",{staticClass:"btn",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleOrder(t.meals[r-1])}}},[t._v("\n                  訂購餐點\n                ")])]},proxy:!0},{key:"distance",fn:function(){return[t._v("\n                ("+t._s(t.meals[r-1].restaurant.distance)+"公尺)\n              ")]},proxy:!0}],null,!0)}):e("NewOrderCard",{style:{backgroundImage:"url(".concat(t.image,")")},scopedSlots:t._u([{key:"content",fn:function(){return[e("h5",{staticClass:"card-title"},[e("span",{staticClass:"card-indicator"},[t._v("附近無其他美食")])]),e("router-link",{staticClass:"btn",attrs:{to:{name:"user-profile"}}},[t._v("\n                  改地點\n                ")])]},proxy:!0}],null,!0)})],1)})),0)])]):t._e(),t.isChoosingMeal?t._e():e("section",{key:"form",staticClass:"order-wrapper"},[e("div",{staticClass:"container order-container"},[e("div",{staticClass:"row order-content p-3"},[e("MealHorizontalCard",{staticClass:"order-display",attrs:{order:t.chosenMeal}}),e("OrderForm",{staticClass:"order-display mt-3",attrs:{"order-info":{quantity:t.chosenMeal.meal.quantity,timeSlots:t.chosenMeal.timeSlots},"initial-processing":t.isProcessing,"current-user":t.currentUser},on:{"change-order":function(e){t.isChoosingMeal=!0},"after-submit":t.handleAfterSubmit}})],1)])])]),e("transition",{attrs:{name:"fade"}},[t.isLoading?t._e():e("Footer")],1)],1)},n=[],s=(r("8e6e"),r("ac6a"),r("456d"),r("a8db")),i=(r("96cf"),r("3b8d")),o=r("bd86"),c=r("1dc8"),l=r("fbbd"),u=r("0489"),d=r("52b6"),p=r("f525"),f=r("075c"),h=r("fd2d"),m=r("555f"),b=r("9b2a"),g=r("2fa3"),v=r("2f62"),_=["Meals","time_slots"];function C(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function y(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?C(Object(r),!0).forEach((function(e){Object(o["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var w={components:{UserNavbar:c["a"],ImageHeaderBanner:l["a"],MealVerticalCard:u["a"],NewOrderCard:p["a"],MealHorizontalCard:d["a"],OrderForm:f["a"],Footer:h["a"],Loader:m["a"]},data:function(){return{banner:{image:"https://images.pexels.com/photos/775031/pexels-photo-775031.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260",height:550},meals:[],isChoosingMeal:!0,chosenMeal:null,isLoading:!0,isProcessing:!1,image:"https://cdn.pixabay.com/photo/2017/06/11/17/03/dumplings-2392893_1280.jpg"}},computed:y({},Object(v["c"])(["currentUser"])),created:function(){this.fetchMeals()},methods:{fetchMeals:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,b["a"].getNewOrder();case 3:if(e=t.sent,r=e.data,a=e.statusText,"OK"===a&&"success"===r.status){t.next=8;break}throw new Error(r.message);case 8:this.meals=r.restaurants.map((function(t){var e=t.Meals,r=t.time_slots,a=Object(s["a"])(t,_);return{meal:e,timeSlots:r,restaurant:a}})),this.isLoading=!1,t.next=17;break;case 12:t.prev=12,t.t0=t["catch"](0),this.isLoading=!1,g["a"].fire({type:"error",title:"無法取得餐點資料，請稍後再試"}),this.$router.push({name:"order-tomorrow"});case 17:case"end":return t.stop()}}),t,this,[[0,12]])})));function e(){return t.apply(this,arguments)}return e}(),handleOrder:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.isChoosingMeal=!1,this.chosenMeal=e;case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),handleAfterSubmit:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var r,a,n,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r=y(y({},e),{},{meal_id:this.chosenMeal.meal.id}),t.next=4,b["a"].postNewOrder(r);case 4:if(a=t.sent,n=a.data,s=a.statusText,"OK"===s&&"success"===n.status){t.next=9;break}throw new Error(n.message);case 9:i=-1*e.quantity,this.$store.commit("updateBalance",i),this.$router.push({name:"order",params:{order_id:n.order_id}}),t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](0),this.isProcessing=!1,g["a"].fire({type:"error",title:"無法成功訂餐，請稍後再試"});case 18:case"end":return t.stop()}}),t,this,[[0,14]])})));function e(e){return t.apply(this,arguments)}return e}()}},O=w,x=(r("92e3"),r("2877")),j=Object(x["a"])(O,a,n,!1,null,"a86a53b2",null);e["default"]=j.exports},"92e3":function(t,e,r){"use strict";r("ccd9")},c710:function(t,e,r){},ccd9:function(t,e,r){},f525:function(t,e,r){"use strict";var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card shadow",attrs:{href:"#"}},[e("div",{staticClass:"card-overlay"}),e("div",{staticClass:"card-body"},[t._t("content")],2)])},n=[],s=(r("747a"),r("2877")),i={},o=Object(s["a"])(i,a,n,!1,null,"3b73e856",null);e["a"]=o.exports}}]);
//# sourceMappingURL=chunk-bc78103c.93d6e862.js.map