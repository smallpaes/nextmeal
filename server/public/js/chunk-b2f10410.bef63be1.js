(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b2f10410"],{6135:function(t,s,e){"use strict";e.r(s);e("b0c0"),e("a9e3");var a=function(){var t=this,s=t._self._c;return s("section",{staticClass:"wrapper d-flex vh-100"},[s("AdminSideNavBar",{attrs:{"nav-is-open":t.navIsOpen}}),s("section",{staticClass:"users flex-fill"},[s("NavbarToggler",{attrs:{"nav-is-open":t.navIsOpen},on:{"toggle-navbar":function(s){t.navIsOpen=!t.navIsOpen}}}),s("h1",{staticClass:"users-title"},[t._v(" 用戶管理 ")]),s("hr",{staticClass:"users-divider"}),s("AdminFilterPanel",{attrs:{options:t.subscriptionStatus,"input-placeholder":"搜尋名稱","is-loading":t.isLoading},on:{"after-search":function(s){return t.handleAfterFilter({sub_status:t.$route.query.sub_status,name:s})},"after-filter":function(s){return t.handleAfterFilter({sub_status:s,name:t.$route.query.name})}},scopedSlots:t._u([{key:"filterOption",fn:function(){return[t._v(" 訂閱狀態 ")]},proxy:!0}])}),s("transition",{attrs:{name:"slide",appear:""}},[t.isLoading||!t.isLoading&&t.users.length>0?s("AdminUsersTable",{attrs:{"is-loading":t.isLoading,users:t.users}}):t._e()],1),s("transition",{attrs:{name:"fade"}},[t.totalPage>1?s("Pagination",{staticClass:"mt-4",attrs:{"total-page":t.totalPage,"current-page":Number(t.$route.query.page)||1,query:{sub_status:this.$route.query.sub_status,name:this.$route.query.name}}}):t._e()],1),t.isLoading||0!==t.users.length?t._e():s("PlaceholderMessage",{staticClass:"users-placeholder"},[s("i",{staticClass:"fas fa-search mr-2"}),t._v("沒有符合的結果 ")])],1)],1)},n=[],r=e("c7eb"),i=e("1da1"),o=(e("d9e2"),e("14d9"),e("e9e5")),u=e("0f14d"),c=e("13ad"),l=function(){var t=this,s=t._self._c;return s("div",{staticClass:"table-wrapper table-borderless table-hover rounded-sm"},[s("table",{staticClass:"table m-0"},[t._m(0),s("tbody",t._l(t.userData,(function(e){return s("tr",{key:e.id,class:{loading:t.isLoading},on:{click:function(s){!t.isLoading&&t.$router.push({name:"admin-user-edit",params:{user_id:e.id}})}}},[s("td",[t.isLoading?s("SkelentonBox",{attrs:{width:"50px"}}):[t._v(" "+t._s(e.name)+" ")]],2),s("td",[t.isLoading?s("SkelentonBox",{attrs:{width:"50px"}}):[t._v(" "+t._s(e.role)+" ")]],2),s("td",[t.isLoading?s("SkelentonBox",{attrs:{width:"16px"}}):[s("span",{class:{isTrue:"active"===e.sub_status,isFalse:"inactive"===e.sub_status},domProps:{innerHTML:t._f("getStatusIcon")(e.sub_status)}})]],2),s("td",{staticClass:"comment"},[t.isLoading?s("SkelentonBox",{attrs:{width:"50px"}}):[t._v(" "+t._s(t._f("getAmount")(e.sub_description))+" ")]],2),s("td",[t.isLoading?s("SkelentonBox",{attrs:{width:"50px"}}):[t._v(" "+t._s(e.order_num)+" 餐 ")]],2)])})),0)])])},d=[function(){var t=this,s=t._self._c;return s("thead",[s("tr",[s("th",{attrs:{scope:"col"}},[t._v(" 名稱 ")]),s("th",{attrs:{scope:"col"}},[t._v(" 用戶權限 ")]),s("th",{attrs:{scope:"col"}},[t._v(" 訂閱狀態 ")]),s("th",{attrs:{scope:"col"}},[t._v(" 訂閱方案 ")]),s("th",{attrs:{scope:"col"}},[t._v(" 點餐量 ")])])])}],p=(e("fb6a"),e("d1b6")),f={components:{SkelentonBox:p["a"]},filters:{getStatusIcon:function(t){return"active"===t?'<i class="fas fa-check"></i>':'<i class="fas fa-times"></i>'},getAmount:function(t){return t?"".concat(t.slice(3,5)," 餐"):"-"}},props:{users:{type:Array,required:!0},isLoading:{type:Boolean,default:!1}},computed:{userData:function(){return this.isLoading?10:this.users}}},h=f,g=(e("af33"),e("2877")),b=Object(g["a"])(h,l,d,!1,null,"29d1c047",null),v=b.exports,_=e("d691"),m=e("1799"),x=e("be6c"),L=e("2fa3"),w={components:{AdminSideNavBar:o["a"],NavbarToggler:u["a"],AdminFilterPanel:c["a"],AdminUsersTable:v,PlaceholderMessage:_["a"],Pagination:m["a"]},data:function(){return{users:[],subscriptionStatus:["active","inactive"],totalPage:null,isLoading:!0,navIsOpen:!1}},created:function(){var t=this.$route.query,s=t.sub_status,e=t.name,a=t.page;this.fetchUsers(s,e,a)},beforeRouteUpdate:function(t,s,e){var a=t.query,n=a.sub_status,r=a.name,i=a.page;this.fetchUsers(n,r,i),e()},methods:{fetchUsers:function(){var t=arguments,s=this;return Object(i["a"])(Object(r["a"])().mark((function e(){var a,n,i,o,u,c;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t.length>0&&void 0!==t[0]?t[0]:"",n=t.length>1&&void 0!==t[1]?t[1]:"",i=t.length>2&&void 0!==t[2]?t[2]:1,e.prev=3,s.isLoading=!0,e.next=7,x["a"].users.getUsers({subscriptionStatus:a,name:n,page:i});case 7:if(o=e.sent,u=o.data,c=o.statusText,"success"===u.status&&"OK"===c){e.next=12;break}throw new Error(u.message);case 12:s.users=u.users,s.subscriptionStatus=u.sub_status||s.subscriptionStatus,s.totalPage=u.pages,s.isLoading=!1,e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](3),s.isLoading=!1,L["a"].fire({type:"error",title:"無法取得用戶資料，請稍後再試"});case 22:case"end":return e.stop()}}),e,null,[[3,18]])})))()},handleAfterFilter:function(t){this.$router.push({name:"admin-users",query:t})}}},y=w,k=(e("dfd9"),Object(g["a"])(y,a,n,!1,null,"13f229e0",null));s["default"]=k.exports},af33:function(t,s,e){"use strict";e("f0c5")},b672:function(t,s,e){},dfd9:function(t,s,e){"use strict";e("b672")},f0c5:function(t,s,e){}}]);
//# sourceMappingURL=chunk-b2f10410.bef63be1.js.map