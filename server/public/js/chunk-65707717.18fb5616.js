(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65707717"],{"7b37":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("section",[t("UserNavbar"),e.isLoading?t("Loader",{attrs:{height:"100vh"}}):e._e(),t("transition",{attrs:{name:"fade"}},[e.isLoading?e._e():t("header",[t("ImageHeaderBanner",{attrs:{"background-photo":e.banner.image,"banner-height":e.banner.height},scopedSlots:e._u([{key:"header",fn:function(){return[t("h1",{staticClass:"banner-content-title"},[e._v("\n            編輯餐點\n          ")]),t("h3",{staticClass:"banner-content-description"},[e._v("\n            更改數量或領餐時間\n          ")])]},proxy:!0}],null,!1,2798758302)})],1)]),t("transition",{attrs:{name:"slide"}},[e.isLoading?e._e():t("section",{staticClass:"order-wrapper"},[t("div",{staticClass:"container order-container"},[t("div",{staticClass:"row order-content p-3"},[t("MealHorizontalCard",{staticClass:"order-display",attrs:{order:e.order}}),t("OrderForm",{staticClass:"order-display mt-3",attrs:{"order-info":{quantity:e.order.meal.quantity+e.order.orderData.quantity,timeSlots:e.order.timeSlots},"initial-order":e.order.orderData,"initial-processing":e.isProcessing,"current-user":e.currentUser},on:{"to-last-page":function(t){return e.$router.go(-1)},"after-submit":e.handleAfterSubmit},scopedSlots:e._u([{key:"submit",fn:function(){return[e._v("\n              更新訂單\n            ")]},proxy:!0}],null,!1,4249549345)})],1)])])]),t("transition",{attrs:{name:"fade"}},[e.isLoading?e._e():t("Footer")],1)],1)},n=[],s=(r("8e6e"),r("ac6a"),r("456d"),r("a8db")),o=(r("96cf"),r("3b8d")),i=r("bd86"),c=r("1dc8"),d=r("fbbd"),u=r("52b6"),p=r("075c"),m=r("fd2d"),h=r("555f"),l=r("9b2a"),f=r("2fa3"),b=r("c1df"),g=r.n(b),O=r("2f62"),y=["Restaurant"];function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){Object(i["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var j={components:{UserNavbar:c["a"],ImageHeaderBanner:d["a"],MealHorizontalCard:u["a"],OrderForm:p["a"],Footer:m["a"],Loader:h["a"]},data:function(){return{banner:{image:"https://images.pexels.com/photos/775031/pexels-photo-775031.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260",height:550},order:{restaurant:{name:"",rating:-1},meal:{name:"",description:"",image:"",quantity:-1},orderData:{quantity:-1,time:""},timeSlots:[]},isLoading:!0,isProcessing:!1}},computed:v({},Object(O["c"])(["currentUser"])),created:function(){var e=this.$route.params.order_id;this.fetchOrder(e)},methods:{fetchOrder:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var r,a,n,o,i,c,d,u,p,m,h;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l["a"].getEditOrder({orderId:t});case 3:if(r=e.sent,a=r.data,n=r.statusText,"OK"===n&&"success"===a.status){e.next=8;break}throw new Error(a.message);case 8:o=a.order,i=o.meals,c=i.Restaurant,d=Object(s["a"])(i,y),u=o.amount,p=o.require_date,m=a.time_slots,h={quantity:u,time:g()(new Date(p)).format("HH:mm")},this.order=v(v({},this.order),{},{restaurant:c,meal:d,orderData:h,timeSlots:m}),this.isLoading=!1,e.next=19;break;case 14:e.prev=14,e.t0=e["catch"](0),this.isLoading=!1,f["a"].fire({type:"error",title:"無法取得訂單資料，請稍後再試"}),this.$router.push({name:"order-tomorrow"});case 19:case"end":return e.stop()}}),e,this,[[0,14]])})));function t(t){return e.apply(this,arguments)}return t}(),handleAfterSubmit:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var r,a,n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l["a"].putEditOrder({orderId:this.$route.params.order_id,formData:t});case 3:if(r=e.sent,a=r.data,n=r.statusText,"OK"===n&&"success"===a.status){e.next=8;break}throw new Error(a.message);case 8:s=this.order.orderData.quantity-t.quantity,this.$store.commit("updateBalance",s),this.$router.push({name:"order",params:{order_id:this.$route.params.order_id}}),e.next=18;break;case 13:e.prev=13,e.t0=e["catch"](0),this.isProcessing=!1,f["a"].fire({type:"error",title:"無法更新訂購資料，請稍後再試"}),this.$router.go(-1);case 18:case"end":return e.stop()}}),e,this,[[0,13]])})));function t(t){return e.apply(this,arguments)}return t}()}},_=j,x=(r("d370"),r("2877")),k=Object(x["a"])(_,a,n,!1,null,"de6a903c",null);t["default"]=k.exports},c801:function(e,t,r){},d370:function(e,t,r){"use strict";r("c801")}}]);
//# sourceMappingURL=chunk-65707717.18fb5616.js.map