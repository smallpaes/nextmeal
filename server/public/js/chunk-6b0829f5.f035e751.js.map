{"version":3,"sources":["webpack:///./src/views/Subscribe.vue?8f5c","webpack:///./src/views/Subscribe.vue","webpack:///src/views/Subscribe.vue","webpack:///./src/views/Subscribe.vue?960f","webpack:///./src/views/Subscribe.vue?9aed"],"names":["render","_vm","this","_c","_self","staticClass","attrs","_v","_l","plans","plan","key","id","isProcessing","on","$event","stopPropagation","handleSubscribe","name","quantity","price","_s","ref","tradeInfo","item","refInFor","staticRenderFns","components","TopLogoNavbar","data","methods","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","subscriptionData","_yield$usersAPI$postS","statusText","wrap","_context","prev","next","sub_balance","sub_description","concat","sub_name","sub_price","usersAPI","postSubscribe","formData","sent","status","Error","message","forEach","$refs","setAttribute","tradeForm","submit","t0","Toast","fire","type","title","stop","component"],"mappings":"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","file":"js/chunk-6b0829f5.f035e751.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Subscribe.vue?vue&type=style&index=0&id=6af5953f&prod&lang=scss&scoped=true&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('section',{staticClass:\"subscribe\"},[_c('TopLogoNavbar'),_c('transition',{attrs:{\"appear\":\"\",\"name\":\"slide\"}},[_c('div',{staticClass:\"subscribe-content rounded\"},[_c('div',{staticClass:\"subscribe-content-top row\"},[_c('div',{staticClass:\"subscribe-content-top-header col-12 mb-4\"},[_c('h3',[_vm._v(\" 方案選擇 \")]),_c('h5',[_vm._v(\" 根據個人需求挑選月繳方案 \")])]),_c('div',{staticClass:\"subscribe-content-top-choices col-12\"},_vm._l((_vm.plans),function(plan){return _c('button',{key:plan.id,staticClass:\"subscribe-choice\",attrs:{\"type\":\"button\",\"disabled\":_vm.isProcessing},on:{\"click\":function($event){$event.stopPropagation();return _vm.handleSubscribe(plan.name, plan.quantity, plan.price)}}},[_c('h4',{staticClass:\"subscribe-choice-header\"},[_vm._v(\" \"+_vm._s(plan.name)+\" \")]),_c('h3',{staticClass:\"subscribe-choice-description\"},[_vm._v(\" \"+_vm._s(plan.quantity)+\" 餐 \"),_c('span',{staticClass:\"subscribe-choice-price d-block mt-2\"},[_vm._v(\"月付 \"+_vm._s(plan.price)+\" 元\")])])])}),0)]),_c('div',{staticClass:\"subscribe-content-bottom\"},[_c('p',{staticClass:\"text-left m-0 mr-3\"},[_vm._v(\" 計算方式：一個月以 30 天計算 \")])]),_c('form',{ref:\"tradeForm\",attrs:{\"action\":\"https://ccore.newebpay.com/MPG/mpg_gateway\",\"method\":\"POST\"}},_vm._l((_vm.tradeInfo),function(item){return _c('input',{key:item,ref:item,refInFor:true,attrs:{\"type\":\"text\",\"name\":item,\"hidden\":\"\"}})}),0)])])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <section class=\"subscribe\">\n    <TopLogoNavbar />\n    <transition\n      appear\n      name=\"slide\"\n    >\n      <div class=\"subscribe-content rounded\">\n        <div class=\"subscribe-content-top row\">\n          <div class=\"subscribe-content-top-header col-12 mb-4\">\n            <h3>\n              方案選擇\n            </h3>\n            <h5>\n              根據個人需求挑選月繳方案\n            </h5>\n          </div>\n          <div class=\"subscribe-content-top-choices col-12\">\n            <button\n              v-for=\"plan in plans\"\n              :key=\"plan.id\"\n              type=\"button\"\n              class=\"subscribe-choice\"\n              :disabled=\"isProcessing\"\n              @click.stop=\"handleSubscribe(plan.name, plan.quantity, plan.price)\"\n            >\n              <h4 class=\"subscribe-choice-header\">\n                {{ plan.name }}\n              </h4>\n              <h3 class=\"subscribe-choice-description\">\n                {{ plan.quantity }} 餐\n                <span class=\"subscribe-choice-price d-block mt-2\">月付 {{ plan.price }} 元</span>\n              </h3>\n            </button>\n          </div>\n        </div>\n        <div class=\"subscribe-content-bottom\">\n          <p class=\"text-left m-0 mr-3\">\n            計算方式：一個月以 30 天計算\n          </p>\n        </div>\n        <form\n          ref=\"tradeForm\"\n          action=\"https://ccore.newebpay.com/MPG/mpg_gateway\"\n          method=\"POST\"\n        >\n          <input\n            v-for=\"item in tradeInfo\"\n            :key=\"item\"\n            :ref=\"item\"\n            type=\"text\"\n            :name=\"item\"\n            hidden\n          >\n        </form>\n      </div>\n    </transition>\n  </section>\n</template>\n\n<script>\nimport TopLogoNavbar from '../components/Navbar/TopLogoNavbar'\nimport usersAPI from '../apis/users'\nimport { Toast } from '../utils/helpers'\n\nexport default {\n  components: {\n    TopLogoNavbar\n  },\n  data () {\n    return {\n      plans: [\n        {\n          id: 1,\n          name: '輕量型',\n          price: 1000,\n          quantity: 10\n        },\n        {\n          id: 2,\n          name: '滿足型',\n          price: 2000,\n          quantity: 20\n        }\n      ],\n      tradeInfo: ['MerchantID', 'TradeInfo', 'TradeSha', 'Version'],\n      isProcessing: false\n    }\n  },\n  methods: {\n    async handleSubscribe (name, quantity, price) {\n      // prepare data for subscription\n      const subscriptionData = {\n        sub_balance: quantity,\n        sub_description: `一個月${quantity}餐`,\n        sub_name: name,\n        sub_price: price\n      }\n\n      try {\n        // update processing status\n        this.isProcessing = true\n        // create new subscription\n        const { data, statusText } = await usersAPI.postSubscribe({ formData: subscriptionData })\n        // error handling\n        if (statusText !== 'OK' || data.status !== 'success') throw new Error(data.message)\n        // prepare form for 藍新\n        this.tradeInfo.forEach(item => this.$refs[item][0].setAttribute('value', data.tradeInfo[item]))\n        // submit the form\n        this.$refs.tradeForm.submit()\n      } catch (error) {\n        // update loading status\n        this.isProcessing = false\n        // fire error messages\n        Toast.fire({\n          type: 'error',\n          title: '訂閱失敗，請稍後再試'\n        })\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@include slideAnimation;\n\n.subscribe {\n  @include setBackground('https://cdn.pixabay.com/photo/2019/03/29/09/26/food-4088832_1280.jpg', 100%);\n  max-height: 100vh;\n  padding: 120px 15px 30px 15px;\n  overflow-y: scroll;\n\n  &-content {\n    max-width: 450px;\n    margin: 0 auto;\n    margin-top: 70px;\n    overflow-y: hidden;\n    background-color: color(quaternary);\n\n    /* Display Two Subscription Plans */\n    &-top {\n      padding: 2.7rem .7rem;\n      margin: 0;\n      width: 100%;\n\n      @include response(xs) { padding: 2.7rem; }\n\n      &-header {\n        text-align: center;\n        h3 { font-size: size(lg); }\n        h5 { font-size: size(sm); }\n      }\n\n      &-choices { @include flexPosition(space-between, center, row); }\n    }\n\n    /* Form Footer */\n    &-bottom {\n      padding: .8rem 2.7rem;\n      font-size: size(xs);\n      color:lighten(color(secondary), 10%);\n      background-color: color(quinary);\n    }\n  }\n\n  /* Subscription Plan Button */\n  &-choice {\n    width: 45%;\n    padding: 0;\n    margin: 0;\n    overflow: hidden;\n    color: rgba(color(secondary), .7);\n    background-color: color(quaternary);\n    border: 0;\n    border-radius: .2rem;\n    box-shadow: 0 .125rem .25rem rgba(0,0,0,.075);\n    transition: all .2s linear;\n\n    &-header {\n      position: relative;\n      padding: .3rem 0;\n      font-size: size(sm);\n      color: color(quaternary);\n      background-color: rgba(color(primary),.9);\n      transition: all .2s linear;\n      @include response(xs) { font-size: size(md); }\n\n      &::after {\n        position: absolute;\n        top: 100%;\n        left: 50%;\n        content: '';\n        border-top: .5rem solid rgba(color(primary),.9);\n        border-right: .5rem solid transparent;\n        border-left: .5rem solid transparent;\n        transform: translateX(-50%);\n      }\n    }\n\n    &-description {\n      @include flexPosition(center, center, column);\n      min-height: 120px;\n      font-size: size(md);\n      @include response(xs) { font-size: size(lg); }\n    }\n\n    &-price { font-size: size(sm); }\n\n    &:hover {\n      color: color(primary);\n      box-shadow: 0 .35rem .5rem rgba(0,0,0,.15);\n      transform: translateY(-3px);\n\n      .subscribe-choice-header { background-color: color(primary); }\n    }\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Subscribe.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Subscribe.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Subscribe.vue?vue&type=template&id=6af5953f&scoped=true&\"\nimport script from \"./Subscribe.vue?vue&type=script&lang=js&\"\nexport * from \"./Subscribe.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Subscribe.vue?vue&type=style&index=0&id=6af5953f&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6af5953f\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}