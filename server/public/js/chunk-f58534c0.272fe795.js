(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f58534c0"],{"7b37":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("section",[t("UserNavbar"),e.isLoading?t("Loader",{attrs:{height:"100vh"}}):e._e(),t("transition",{attrs:{name:"fade"}},[e.isLoading?e._e():t("header",[t("ImageHeaderBanner",{attrs:{"background-photo":e.banner.image,"banner-height":e.banner.height},scopedSlots:e._u([{key:"header",fn:function(){return[t("h1",{staticClass:"banner-content-title"},[e._v(" 編輯餐點 ")]),t("h3",{staticClass:"banner-content-description"},[e._v(" 更改數量或領餐時間 ")])]},proxy:!0}],null,!1,2727127774)})],1)]),t("transition",{attrs:{name:"slide"}},[e.isLoading?e._e():t("section",{staticClass:"order-wrapper"},[t("div",{staticClass:"container order-container"},[t("div",{staticClass:"row order-content p-3"},[t("MealHorizontalCard",{staticClass:"order-display",attrs:{order:e.order}}),t("OrderForm",{staticClass:"order-display mt-3",attrs:{"order-info":{quantity:e.order.meal.quantity+e.order.orderData.quantity,timeSlots:e.order.timeSlots},"initial-order":e.order.orderData,"initial-processing":e.isProcessing,"current-user":e.currentUser},on:{"to-last-page":function(t){return e.$router.go(-1)},"after-submit":e.handleAfterSubmit},scopedSlots:e._u([{key:"submit",fn:function(){return[e._v(" 更新訂單 ")]},proxy:!0}],null,!1,779348833)})],1)])])]),t("transition",{attrs:{name:"fade"}},[e.isLoading?e._e():t("Footer")],1)],1)},n=[],s=r("c7eb"),o=r("15fd"),i=r("1da1"),d=r("5530"),c=(r("d9e2"),r("14d9"),r("1dc8")),u=r("fbbd"),l=r("52b6"),m=r("075c"),p=r("fd2d"),f=r("555f"),h=r("9b2a"),b=r("2fa3"),g=r("c1df"),v=r.n(g),w=r("2f62"),O=["Restaurant"],y={components:{UserNavbar:c["a"],ImageHeaderBanner:u["a"],MealHorizontalCard:l["a"],OrderForm:m["a"],Footer:p["a"],Loader:f["a"]},data:function(){return{banner:{image:"https://images.pexels.com/photos/775031/pexels-photo-775031.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260",height:550},order:{restaurant:{name:"",rating:-1},meal:{name:"",description:"",image:"",quantity:-1},orderData:{quantity:-1,time:""},timeSlots:[]},isLoading:!0,isProcessing:!1}},computed:Object(d["a"])({},Object(w["c"])(["currentUser"])),created:function(){var e=this.$route.params.order_id;this.fetchOrder(e)},methods:{fetchOrder:function(e){var t=this;return Object(i["a"])(Object(s["a"])().mark((function r(){var a,n,i,c,u,l,m,p,f,g,w;return Object(s["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,h["a"].getEditOrder({orderId:e});case 3:if(a=r.sent,n=a.data,i=a.statusText,"OK"===i&&"success"===n.status){r.next=8;break}throw new Error(n.message);case 8:c=n.order,u=c.meals,l=u.Restaurant,m=Object(o["a"])(u,O),p=c.amount,f=c.require_date,g=n.time_slots,w={quantity:p,time:v()(new Date(f)).format("HH:mm")},t.order=Object(d["a"])(Object(d["a"])({},t.order),{},{restaurant:l,meal:m,orderData:w,timeSlots:g}),t.isLoading=!1,r.next=19;break;case 14:r.prev=14,r.t0=r["catch"](0),t.isLoading=!1,b["a"].fire({type:"error",title:"無法取得訂單資料，請稍後再試"}),t.$router.push({name:"order-tomorrow"});case 19:case"end":return r.stop()}}),r,null,[[0,14]])})))()},handleAfterSubmit:function(e){var t=this;return Object(i["a"])(Object(s["a"])().mark((function r(){var a,n,o,i;return Object(s["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,h["a"].putEditOrder({orderId:t.$route.params.order_id,formData:e});case 3:if(a=r.sent,n=a.data,o=a.statusText,"OK"===o&&"success"===n.status){r.next=8;break}throw new Error(n.message);case 8:i=t.order.orderData.quantity-e.quantity,t.$store.commit("updateBalance",i),t.$router.push({name:"order",params:{order_id:t.$route.params.order_id}}),r.next=18;break;case 13:r.prev=13,r.t0=r["catch"](0),t.isProcessing=!1,b["a"].fire({type:"error",title:"無法更新訂購資料，請稍後再試"}),t.$router.go(-1);case 18:case"end":return r.stop()}}),r,null,[[0,13]])})))()}}},_=y,x=(r("d370"),r("2877")),j=Object(x["a"])(_,a,n,!1,null,"de6a903c",null);t["default"]=j.exports},"855e":function(e,t,r){},d370:function(e,t,r){"use strict";r("855e")}}]);
//# sourceMappingURL=chunk-f58534c0.272fe795.js.map